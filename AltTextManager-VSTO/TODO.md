# TODO - PowerPoint 대체 텍스트 관리자

## 🔴 긴급 (즉시 해결 필요)

### 1. 리본 UI 포함하여 재빌드
**상태**: ⏳ 대기 중
**우선순위**: 높음
**설명**:
- AltTextRibbon.cs/Designer.cs 파일을 프로젝트에 추가했으나 아직 재빌드하지 않음
- Visual Studio에서 Ctrl+Shift+B로 빌드 필요

**작업 순서**:
```
1. Visual Studio에서 AltTextManager.csproj 열기
2. 빌드 → 솔루션 빌드 (Ctrl+Shift+B)
3. 빌드 성공 확인
```

### 2. ClickOnce 서명 문제 해결
**상태**: ⚠️ 우회 중 (레지스트리 수동 설치 사용)
**우선순위**: 중간
**설명**:
- 현재 DLL은 빌드되지만 ClickOnce 매니페스트 서명 단계에서 실패
- 수동 매니페스트 파일을 생성하여 임시 해결
- 프로덕션 배포를 위해서는 정식 인증서 필요

**해결 방법 옵션**:
- [ ] 옵션 1: Visual Studio에서 테스트 인증서 생성
- [ ] 옵션 2: 프로젝트 속성에서 서명 탭 → "ClickOnce 매니페스트 서명" 체크 후 인증서 생성
- [ ] 옵션 3: 개발 환경에서는 서명 없이 사용 (현재 방식 유지)

## 🟡 중요 (빌드 후 진행)

### 3. 재설치 및 테스트
**상태**: ⏳ 재빌드 후 진행
**우선순위**: 높음
**작업 순서**:
```powershell
# 1. 재설치
cd P:\Project\pptx-addon\AltTextManager-VSTO
.\install-manual.ps1

# 2. PowerPoint 재시작
# 3. COM 애드인 목록 확인
```

### 4. PowerPoint 리본 UI 확인
**상태**: ⏳ 재설치 후 테스트
**우선순위**: 높음
**확인 사항**:
- [ ] PowerPoint 실행 시 "애드인" 탭에 "대체 텍스트" 그룹 표시
- [ ] "대체 텍스트 관리자" 버튼 표시
- [ ] 버튼 클릭 시 관리자 창 열림

### 5. 대체 텍스트 관리자 폼 기능 테스트
**상태**: ⏳ 리본 UI 테스트 후 진행
**우선순위**: 높음
**테스트 항목**:
- [ ] 슬라이드 요소 목록 표시
- [ ] 요소 선택 시 현재 대체 텍스트 표시
- [ ] 선택한 요소에 대체 텍스트 적용
- [ ] 모든 요소에 일괄 적용
- [ ] 새로고침 버튼 동작
- [ ] 폼 닫기

### 6. 템플릿 기반 자동 생성 테스트
**상태**: ⏳ 기본 기능 테스트 후 진행
**우선순위**: 중간
**테스트 항목**:
- [ ] "접두사 + 요소 이름" 템플릿
- [ ] "타입별 템플릿" ({type}: {name})
- [ ] "사용자 정의 템플릿" ({name}, {type}, {index})
- [ ] "빈 요소만 적용" 옵션
- [ ] 템플릿 샘플 텍스트 업데이트

### 7. 일괄 작업 테스트
**상태**: ⏳ 자동 생성 테스트 후 진행
**우선순위**: 중간
**테스트 항목**:
- [ ] 모든 요소에 대체 텍스트 일괄 적용
- [ ] 모든 대체 텍스트 삭제
- [ ] 확인 대화상자 표시
- [ ] 작업 후 상태 업데이트

## 🟢 개선 사항 (선택적)

### 8. VBA에서 애드인 메서드 호출 방법 개선
**상태**: ⏳ 검토 필요
**우선순위**: 낮음
**현재 문제**:
- `addIn.Object.ShowAltTextManager` 호출 시 오류 발생
- VSTO 애드인의 public 메서드가 COM으로 직접 노출되지 않음

**해결 방법**:
- [x] 리본 UI 추가 (현재 선택한 방법)
- [ ] COM 인터페이스 명시적 정의
- [ ] RequestComAddInAutomationService 사용

**참고**: 리본 UI를 통해 관리자 창을 열 수 있으므로 VBA 호출은 선택사항

### 9. 프로덕션 배포 준비
**상태**: ⏳ 기능 테스트 완료 후
**우선순위**: 낮음
**작업 항목**:
- [ ] 정식 코드 서명 인증서 구매 또는 생성
- [ ] ClickOnce 배포 설정 완료
- [ ] 설치 프로그램 테스트
- [ ] 사용자 매뉴얼 작성
- [ ] 배포 패키지 생성

### 10. 추가 기능 고려사항
**상태**: 💡 아이디어
**우선순위**: 낮음
**가능한 개선사항**:
- [ ] 여러 슬라이드 동시 처리
- [ ] 대체 텍스트 내보내기/가져오기 (CSV, Excel)
- [ ] 대체 텍스트 미리보기
- [ ] 실행 취소/다시 실행 기능
- [ ] 대체 텍스트 검증 (길이 제한, 규칙 체크)
- [ ] 다국어 지원
- [ ] 테마 지원 (다크 모드)

## 📋 완료된 작업

### ✅ 2025-11-24
- [x] VSTO 프로젝트 구조 생성
- [x] ThisAddIn.cs 구현
- [x] AltTextManagerForm.cs Windows Forms UI 구현
- [x] InputDialog.cs 사용자 입력 다이얼로그 구현
- [x] PowerPoint Interop 통합
- [x] 템플릿 기반 자동 생성 기능 구현
- [x] 모든 컴파일 오류 수정
- [x] Visual Studio 2025에서 DLL 빌드 성공
- [x] 수동 매니페스트 파일 생성
- [x] 레지스트리 설치 스크립트 작성
- [x] PowerPoint COM 애드인 등록 완료
- [x] 애드인 활성화 확인
- [x] 리본 UI 코드 작성 (AltTextRibbon.cs/Designer.cs)
- [x] 프로젝트 문서화 (README, BUILD_GUIDE, PROJECT_STATUS)
- [x] Git 커밋

## 🐛 알려진 문제

### Issue #1: ClickOnce 매니페스트 서명 오류
**증상**:
```
error: Cannot build because the ClickOnce manifest signing option is not selected.
```
**영향**: .vsto 파일이 자동 생성되지 않음
**임시 해결**: 수동으로 매니페스트 파일 생성 및 레지스트리 설치
**영구 해결**: 인증서 생성 및 서명 설정 필요

### Issue #2: VBA에서 애드인 메서드 직접 호출 불가
**증상**: `addIn.Object.ShowAltTextManager` 오류
**영향**: VBA 매크로로 관리자 창 열기 불가
**해결**: 리본 UI 버튼 사용 (재빌드 필요)

## 📝 참고사항

### 빌드 환경
- Visual Studio 2025 Community
- .NET Framework 4.7.2
- PowerPoint 2016/2019/2021/365

### 테스트 환경
- Windows 10/11
- PowerPoint 데스크톱 버전
- VSTO Runtime 설치 필요

### 배포 방법
1. **개발/테스트**: 레지스트리 수동 설치 (install-manual.ps1)
2. **프로덕션**: ClickOnce 배포 (인증서 서명 필요)
